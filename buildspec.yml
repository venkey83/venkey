version: 0.2

phases:
  install:
    runtime-versions:
      python: 3.7
  pre_build:
    commands:
      - while [ $(aws rds describe-db-instances --db-instance-identifier venkey | grep -c available) -eq 0 ]; do echo "sleep 60s"; sleep 60; done
      - echo "Temp db ready"
      - export ENDPOINT=venkey-$DATE.czrrfh9ifhyq.ap-southeast-1.rds.amazonaws.com
      - echo $ENDPOINT
      - echo Build started on `date`
  build:
    commands:
      - echo Build started on `date` ---
      - echo proceed db connection to $ENDPOINT
      - echo proceed db migrate update, DDL proceed here
      - echo proceed application test, CRUD test run here
      
  post_build:
    commands:
      - echo Build completed on `date` --
      - echo $DBNAME
      - echo $ENDPOINT
      
